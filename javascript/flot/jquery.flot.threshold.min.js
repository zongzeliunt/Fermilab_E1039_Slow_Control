(function(b){var a={series:{threshold:null}};function c(d){function e(o,w,n){if(!w.threshold){return}var f=n.pointsize,k,r,q,g,l,j=b.extend({},w);j.datapoints={points:[],pointsize:f};j.label=null;j.color=w.threshold.color;j.threshold=null;j.originSeries=w;j.data=[];var u=w.threshold.below,t=n.points,v=w.lines.show;threspoints=[];newpoints=[];for(k=0;k<t.length;k+=f){r=t[k];q=t[k+1];l=g;if(q<u){g=threspoints}else{g=newpoints}if(v&&l!=g&&r!=null&&k>0&&t[k-f]!=null){var h=(r-t[k-f])/(q-t[k-f+1])*(u-q)+r;l.push(h);l.push(u);for(m=2;m<f;++m){l.push(t[k+m])}g.push(null);g.push(null);for(m=2;m<f;++m){g.push(t[k+m])}g.push(h);g.push(u);for(m=2;m<f;++m){g.push(t[k+m])}}g.push(r);g.push(q)}n.points=newpoints;j.datapoints.points=threspoints;if(j.datapoints.points.length>0){o.getData().push(j)}}d.hooks.processDatapoints.push(e)}b.plot.plugins.push({init:c,options:a,name:"threshold",version:"1.0"})})(jQuery);
(function(b){var a={series:{stack:null}};function c(f){function d(k,j){var h=null;for(var g=0;g<j.length;++g){if(k==j[g]){break}if(j[g].stack==k.stack){h=j[g]}}return h}function e(C,w,g){if(w.stack==null){return}var n=d(w,C.getData());if(!n){return}var z=g.pointsize,F=g.points,u=n.datapoints.pointsize,J=n.datapoints.points,q=[],x,v,r,I,H,k,t=w.lines.show,G=w.bars.horizontal,p=z>2&&(G?g.format[2].x:g.format[2].y),h=t&&w.lines.steps,E=true,o=G?1:0,y=G?0:1,D=0,B=0,A;while(true){if(D>=F.length){break}A=q.length;if(F[D]==null){for(m=0;m<z;++m){q.push(F[D+m])}D+=z}else{if(B>=J.length){if(!t){for(m=0;m<z;++m){q.push(F[D+m])}}D+=z}else{if(J[B]==null){for(m=0;m<z;++m){q.push(null)}E=true;B+=u}else{x=F[D+o];v=F[D+y];I=J[B+o];H=J[B+y];k=0;if(x==I){for(m=0;m<z;++m){q.push(F[D+m])}q[A+y]+=H;k=H;D+=z;B+=u}else{if(x>I){if(t&&D>0&&F[D-z]!=null){r=v+(F[D-z+y]-v)*(I-x)/(F[D-z+o]-x);q.push(I);q.push(r+H);for(m=2;m<z;++m){q.push(F[D+m])}k=H}B+=u}else{if(E&&t){D+=z;continue}for(m=0;m<z;++m){q.push(F[D+m])}if(t&&B>0&&J[B-u]!=null){k=H+(J[B-u+y]-H)*(x-I)/(J[B-u+o]-I)}q[A+y]+=k;D+=z}}E=false;if(A!=q.length&&p){q[A+2]+=k}}}}if(h&&A!=q.length&&A>0&&q[A]!=null&&q[A]!=q[A-z]&&q[A+1]!=q[A-z+1]){for(m=0;m<z;++m){q[A+z+m]=q[A+m]}q[A+1]=q[A-z+1]}}g.points=q}f.hooks.processDatapoints.push(e)}b.plot.plugins.push({init:c,options:a,name:"stack",version:"1.2"})})(jQuery);